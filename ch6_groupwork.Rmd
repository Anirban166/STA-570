---
title: "Chapter 6 Groupwork"
author: "Brit Riggs, Anirban Chetia"
date: "9/28/2021"
output: pdf_document
---

## Question 1

### (a)
Answer: Done (GOT IT)

```{r, message = FALSE, warning = FALSE, echo = FALSE}
suppressPackageStartupMessages({
library(knitr)
library(dplyr)
library(boot)
library(ggplot2)
})
```

```{r}
Q1.sample <- c(5.1, 4.9, 5.6,	4.2, 4.8,	4.5, 5.3,	5.2)
kable(c(Mean = mean(Q1.sample), Standard.Deviation = sd(Q1.sample)))
```

### (b)
Answer: Done (GOT IT)

```{r}
n <- length(Q1.sample)
df <- n - 1
alpha = 1 - 0.95
upper.limit <- mean(Q1.sample) + qt(1 - (alpha/2), df)*(sd(Q1.sample)/sqrt(n))
lower.limit <- mean(Q1.sample) - qt(1 - (alpha/2), df)*(sd(Q1.sample)/sqrt(n))
```

Required confidence interval:
$$
\bar{x}\pm t^{(1-\alpha)}_{df}*\sigma/\sqrt{n}
$$
```{r}
paste0("(", lower.limit, ", ", upper.limit, ")")
```
The assumption being made here is that the sample size (n) is big enough for the Central Limit Theorem (CLT) to be applied.

### (c)
Answer: Done (GOT IT)

```{r}
mean.function <- function(x, index) {
  d <- x[index]    
  return(mean(d))
}
Boot.sample <- boot(data = Q1.sample,
                    statistic = mean.function, R = 10000)
```

Required confidence interval:
```{r}
quantile(Boot.sample$t, probs = c(.025, .975))
```

```{r}
Boot.sample.graph <- data.frame(xbar = Boot.sample$t)
ggplot(Boot.sample.graph, aes(x = xbar)) +
    geom_histogram() + 
    ggtitle('Estimated Sampling distribution of bootstrap replicates (means)' )
```
The distribution that I observe (via a histogram of the bootstrap replicates) is almost equivalent to that of a normal distribution (in which case, my assumption of it being normal is true), which indicates that my assumption in 1(c) is true or valid. (i.e. the sample size n is large enough to apply the CLT with a normal-like distribution)

### (d)
Answer: Done (GOT IT)

```{r}
# 1 sided hypothesis test that the mean oxygen level is less than 5ppm, alpha = 0.05 or 1 - 0.95 (c)
u0 = 5 #ppm
alpha = 0.05
df = n - 1
t.crit <- qt(alpha, df)
x.crit <- t.crit*(sd(Q1.sample)/sqrt(n)) + u0
# pvalue of the test statistic:
test.statistic <- (mean(Q1.sample)-u0)/(sd(Q1.sample)/sqrt(n))
pvalue = pt(test.statistic, df)
pvalue
```
We obtained a p-value > 0.05, which is not statistically significant and indicates strong evidence for the null hypothesis, i.e. the mean oxygen level is less than 5ppm, or at least that we cannot reject our null hypothesis.

$$
t_{crit} = t^{\alpha}_{df} = -1.894579
$$

### (e)
Answer: Done (GOT IT)

```{r}
t.test(c(5.1, 4.9, 5.6,	4.2, 4.8,	4.5, 5.3,	5.2), alternative = "two.sided")
```

## Question 2

### (a)
Answer: Done (GOT IT)

```{r}
Q2.sample <- c(91.9, 97.8, 111.4,	122.3, 105.4,	95.0, 103.8, 99.6, 96.6, 119.3,	104.8, 101.7)
n = length(Q2.sample)
df = n - 1
alpha = 1 - 0.9
upper.limit <- mean(Q2.sample) + qt(1 - (alpha/2), df)*(sd(Q2.sample)/sqrt(n))
lower.limit <- mean(Q2.sample) - qt(1 - (alpha/2), df)*(sd(Q2.sample)/sqrt(n))
```

Required confidence interval:
$$
\bar{x}\pm t^{(1-\alpha)}_{df}*\sigma/\sqrt{n}
$$
```{r}
paste0("(", lower.limit, ", ", upper.limit, ")")
```

### (b)
Answer: Done (GOT IT)

Let's consider the null hypothesis to be that the mean of the radons given by the radon detectors is equal t0 105 pico-curies/liter of radon. The alternative hypothesis would be that the radons given by the radon detectors is not equal to 105 pico-curies/liter of radon.

$$
 H_o : \mu = 105\ pCi/l
$$
$$
 H_a : \mu \neq 105\ pCi/l
$$
The reason why we are considering a two-sided test is because we require both sides, or both sides are significant for different purposes. For instance, a value > 105 pCi/l or at the higher end would be important as because more radons would pose as a health risk for us. On the other hand, a value < 105 pCi/l or at the lower end would be important as that may provide a false alarm for the radon detectors giving a signal at a lower level, which would be annoying and undesirable. 

### (c)
Answer: Done (GOT IT)

```{r}
u0 = 105
test.statistic <- (mean(Q2.sample)-u0)/(sd(Q2.sample)/sqrt(n))
```

### (d)
Answer: Done (GOT IT)

```{r}
pvalue = pt(test.statistic, df)
pvalue
```

### (e)
Answer: Done (GOT IT)

### (f)
Answer: Done (GOT IT)

```{r}

```

---
title: "STA 570 -- Ch. 8 Homework"
author: "Brit Riggs"
date: "`r format(Sys.time(),  '%B %d, %Y')`"
output: pdf_document
---

```{r, message = FALSE, warning = FALSE, echo = FALSE}
suppressPackageStartupMessages({
  library(boot)
  library(knitr)
  library(dplyr)
  library(tidyr)
  library(mosaic)
  library(ggplot2)
  library(latex2exp)
})
```

## Exercise 1

### (a)
Answer: \textbf{Done (GOT IT)}

```{r}
# i. P(F 5,5 < 1/2)
pf(1/2, 5, 5)
# ii. P(F 5,5 > 2/1)
1-pf(2, 5, 5)
# iii. P(F 4,10 > 6/1)
1-pf(6, 4, 10)
# iv. P(F 10,4 < 1/6)
pf(1/6, 10, 4)
```

### (b)
Answer: \textbf{Done (GOT IT)}

Part (i) and (ii) are equal and part (iii) and (iv) are equal because the F Distribution is symmetrical.

## Exercise 2

### (a)
Answer: \textbf{Done (GOT IT)}

```{r}
finalData <- data.frame(nvalue = numeric(), pvalue = numeric(), statistic = numeric())
n <- 5                           # sample size is 5
x <- rnorm(n, mean = 25, sd = 5) # draw random sample from a normal distribution
first.case <- data.frame(nvalue = n, pvalue = shapiro.test(x)$p.value, statistic = shapiro.test(x)$statistic)
finalData <- rbind(finalData, first.case)
n <- 25                          # sample size is 5
x <- rnorm(n, mean = 25, sd = 5) # draw random sample from a normal distribution
second.case <- data.frame(nvalue = n, pvalue = shapiro.test(x)$p.value, statistic = shapiro.test(x)$statistic)
finalData <- rbind(finalData, second.case)
n <- 100                         # sample size is 5
x <- rnorm(n, mean = 25, sd = 5) # draw random sample from a normal distribution
third.case <- data.frame(nvalue = n, pvalue = shapiro.test(x)$p.value, statistic = shapiro.test(x)$statistic)
finalData <- rbind(finalData, third.case)
n <- 400                         # sample size is 5
x <- rnorm(n, mean = 25, sd = 5) # draw random sample from a normal distribution
fourth.case <- data.frame(nvalue = n, pvalue = shapiro.test(x)$p.value, statistic = shapiro.test(x)$statistic)
finalData <- rbind(finalData, fourth.case)
finalData %>% kable()
```

### (b)
Answer: \textbf{Done (GOT IT)}

```{r}
finalData <- data.frame(nvalue = numeric(), pvalue = numeric(), statistic = numeric())
n <- 5                              # sample size is 5
x <- rgamma(n, shape = 3, rate = 2) # draw random sample from a gamma distribution
first.case <- data.frame(nvalue = n, pvalue = shapiro.test(x)$p.value, statistic = shapiro.test(x)$statistic)
finalData <- rbind(finalData, first.case)
n <- 25                             # sample size is 5
x <- rgamma(n, shape = 3, rate = 2) # draw random sample from a gamma distribution
second.case <- data.frame(nvalue = n, pvalue = shapiro.test(x)$p.value, statistic = shapiro.test(x)$statistic)
finalData <- rbind(finalData, second.case)
n <- 100                            # sample size is 5
x <- rgamma(n, shape = 3, rate = 2) # draw random sample from a gamma distribution
third.case <- data.frame(nvalue = n, pvalue = shapiro.test(x)$p.value, statistic = shapiro.test(x)$statistic)
finalData <- rbind(finalData, third.case)
n <- 400                            # sample size is 5
x <- rgamma(n, shape = 3, rate = 2) # draw random sample from a gamma distribution
fourth.case <- data.frame(nvalue = n, pvalue = shapiro.test(x)$p.value, statistic = shapiro.test(x)$statistic)
finalData <- rbind(finalData, fourth.case)
finalData %>% kable()
```


## Exercise 3

### (a)
Answer: \textbf{Done (GOT IT)}

```{r}
par(mfrow = c(1,1)) # 1 row of 1: Just one graph
n <- 5 
sigma <- c(2,2)   # Standard deviations of each group
my.data <- data.frame(y = c(rnorm(n, mean = 0, sd = sigma[1]),
                            rnorm(n, mean = 0, sd = sigma[2])),
                      group = c(rep('g1', n), rep('g2', n)))
boxplot(y ~ group, data = my.data) 
var.test(y ~ group, data = my.data)
```

### (b)
Answer: \textbf{Done (GOT IT)}

```{r}
par(mfrow = c(1,1)) # 1 row of 1: Just one graph
n <- 5 
sigma <- c(2,4)   # Standard deviations of each group
my.data <- data.frame(y = c(rnorm(n, mean = 0, sd = sigma[1]),
                            rnorm(n, mean = 0, sd = sigma[2])),
                      group = c(rep('g1', n), rep('g2', n)))
boxplot(y ~ group, data = my.data) 
var.test(y ~ group, data = my.data)
```

The F-test rejects more frequently.

### (c)
Answer: \textbf{Done (GOT IT)}

```{r}
par(mfrow = c(1,1)) # 1 row of 1: Just one graph
n <- 50 
sigma <- c(2,2)   # Standard deviations of each group
my.data <- data.frame(y = c(rnorm(n, mean = 0, sd = sigma[1]),
                            rnorm(n, mean = 0, sd = sigma[2])),
                      group = c(rep('g1', n), rep('g2', n)))
boxplot(y ~ group, data = my.data) 
var.test(y ~ group, data = my.data)
```

As the sample size increases, the box widths become more consistent.

## Exercise 4

### (a)
Answer: \textbf{Done (GOT IT)}

```{r}
# H0 : var1 = var2
# Ha : var1 neq var2
n1    <- 15
xbar1 <- 52
s1    <- 7
n2    <- 20
xbar2 <- 42
s2    <- 4
# alpha <- 0.05
# all calc done by hand!
# perform F test to see if variances are different (0.025)
f <- s1^2/s2^2  # f <- var1/var2
2*(1-pf(f, n1-1, n2-1))
```

At 5% significance, we reject the null hypothesis because the p-value is smaller than alpha.

## Exercise 5

### (a)
Answer: \textbf{Done (GOT IT)}

```{r}
lifespan <- data.frame(
  time = c(19.25,19.7,19.75,19.9,19.95,20.05,20.13,20.2,20.4,20.6,
           9.7,9.75,9.8,9.82,9.85,9.90,9.92,9.96,10.01,10.02,10.10,
           10.11,10.13,10.19,10.28,10.31),
  type = c( rep('110',10), rep('220',16)))

Group1Data <- lifespan %>% filter(type == '110')
Group2Data <- lifespan %>% filter(type == '220')
```

Mean and variance of each sample group:

```{r}
c(mean(Group1Data$time), var(Group1Data$time), length(Group1Data$time))
c(mean(Group2Data$time), var(Group2Data$time), length(Group2Data$time))
```

### (b)
Answer: \textbf{Done (GOT IT)}

(i)
```{r}
qqnorm(Group1Data$time)
qqline(Group1Data$time)
```      
I observe that Group 1 is normally distributed.
```{r}      
qqnorm(Group2Data$time)
qqline(Group2Data$time)
```
I observe that Group 2 is normally distributed as well.

(ii)
```{r}
shapiro.test(Group1Data$time)
shapiro.test(Group2Data$time)
```

The large p-values in each case tell me that my assumptions for both Group 1 and Group 2 are right.

### (c)
Answer: \textbf{Done (GOT IT)}

(i) Calculating the standard deviations:
```{r}
c(sd(Group1Data$time), sd(Group2Data$time))
```

Calculating the f-statistic:
```{r}
f = (sd(Group1Data$time)/sd(Group2Data$time))^2
```

Calculating the p-value:
```{r}
2*(1-pf(f, 9, 15))
```

(ii) 

```{r}
var.test(time ~ type, data = lifespan)
```
From the observed test result, I verify that my calculations are right. (complying with the values I obtained in (i))
